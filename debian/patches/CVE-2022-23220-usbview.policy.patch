Description: Fix authorization for inactive or arbitrary other users (CVE-2022-23220)
 The original settings effectively mean that only a user in a local and
 active (graphical) session needs to enter a root password to run
 usbview as root. Users in inactive (e.g. locked) sessions or arbitrary
 other users (e.g. logged in via SSH) can run usbview as root without
 providing any authentication at all.
Origin: vendor
Bug-Debian-Security: https://security-tracker.debian.org/tracker/CVE-2022-23220
Author: Matthias Gerstner <mgerstner@suse.de>
Reviewed-by: Salvatore Bonaccorso <carnil@debian.org>
Last-Update: 2022-01-15

diff --git a/org.freedesktop.pkexec.usbview.policy b/org.freedesktop.pkexec.usbview.policy
index 0f0bb34..d2c477d 100644
--- a/org.freedesktop.pkexec.usbview.policy
+++ b/org.freedesktop.pkexec.usbview.policy
@@ -8,8 +8,8 @@
     <message>Authentication is required to view USB bus</message>
     <icon_name>usbview_icon</icon_name>
     <defaults>
-      <allow_any>yes</allow_any>
-      <allow_inactive>yes</allow_inactive>
+      <allow_any>no</allow_any>
+      <allow_inactive>no</allow_inactive>
       <allow_active>auth_admin_keep</allow_active>
     </defaults>
     <annotate key="org.freedesktop.policykit.exec.path">/usr/bin/usbview</annotate>
